<head>
  <script src="https://f.vimeocdn.com/js/froogaloop2.min.js"></script>
</head>

<body style="height: 100%; width: 100%;">

</body>
<script>
  const PLAYER_ID = 'player';

  function webViewBridge() {

  function getParameterByName(name, url) {
    // From http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
    if (!url) url = window.location.href;
    url = url.toLowerCase(); // This is just to avoid case sensitiveness
    name = name.replace(/[\[\]]/g, '\\$&').toLowerCase(); // This is just to avoid case sensitiveness for query parameter name
    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
      results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
  }

    const vid = getParameterByName('vid');
    if (!vid) {
      console.log('No `vid` parameter found, not loading Vimeo iframe')
      return;
    }
    // Generate iframe based on `vid` parameter
    let iframe;
    iframe = document.createElement('iframe');
    iframe.src =
      'https://player.vimeo.com/video/' + vid + '?api=1&player_id=' + PLAYER_ID;
    iframe.width = '100%';
    iframe.height = '98%';
    iframe.frameBorder = '0';
    iframe.webkitallowfullscreen = true;
    iframe.allowfullscreen = true;
    iframe.id = PLAYER_ID;
    document.body.appendChild(iframe);
    const player = $f(iframe);


    player.addEvent('ready', function () {
      player.addEvent('play', function (data) {
        return sendMessageToRN("PLAYING")
      });
      // player.addEvent('playProgress', function (data) {
      //   return sendMessageToRN("PROGRESS")
      // });
      player.addEvent('pause', function (data) {
        return sendMessageToRN("PAUSED")
      });
      player.addEvent('finish', function (data) {
        return sendMessageToRN("ENDED")
      });
    });


    function sendMessageToRN(message) {
      if (window.ReactNativeWebView.postMessage.length !== 1) {
        setTimeout(sendMessageToRN(message), 200);
      } else {
        window.ReactNativeWebView.postMessage(message);
      }
    }
  }

webViewBridge();

</script>